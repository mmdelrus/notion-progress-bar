<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion Progress Bar</title>
    <style>
        body { font-family: Arial, sans-serif; background: transparent; padding: 20px; text-align: center; }
        .progress-container { margin-bottom: 10px; }
        .progress-label { font-size: 16px; margin-bottom: 5px; }
        .progress-bar { width: 100%; max-width: 300px; height: 20px; background: #eee; border-radius: 10px; position: relative; margin: auto; }
        .progress-fill { height: 100%; width: 0%; border-radius: 10px; transition: width 0.8s ease-in-out; background-color: #ffcc80; }
    </style>
</head>
<body>
    <h2>ðŸ“š My Reading Progress</h2>
    <div id="progress-bars"></div>

<script>
    const NOTION_API_KEY = "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";  // Replace this!
    const DATABASE_ID = "19ccb1ff5e8e80129992ef20c005a5e6";        // Replace this!
    
    async function fetchBookProgress() {
        const response = await fetch(`https://api.notion.com/v1/databases/${DATABASE_ID}/query`, {
            method: "POST",
            headers: {
                "Authorization": `Bearer ${NOTION_API_KEY}`,
                "Content-Type": "application/json",
                "Notion-Version": "2022-06-28"
            }
        });

        const data = await response.json();
        return data.results.map(page => ({
            title: page.properties.Name.title[0].text.content,
            progress: page.properties.Progress.number,  // Adjust this if your progress property is named differently
            color: page.properties.Color?.rich_text?.[0]?.text?.content || "#ffcc80"
        }));
    }

    async function updateProgressBars() {
        const books = await fetchBookProgress();
        const container = document.getElementById("progress-bars");
        container.innerHTML = "";  // Clear old bars

        books.forEach(book => {
            const div = document.createElement("div");
            div.classList.add("progress-container");

            const label = document.createElement("div");
            label.classList.add("progress-label");
            label.innerText = `${book.title}: ${book.progress}%`;

            const bar = document.createElement("div");
            bar.classList.add("progress-bar");

            const fill = document.createElement("div");
            fill.classList.add("progress-fill");
            fill.style.width = `${book.progress}%`;
            fill.style.background = book.color;

            bar.appendChild(fill);
            div.appendChild(label);
            div.appendChild(bar);
            container.appendChild(div);
        });
    }

    updateProgressBars();  // Run on load
    setInterval(updateProgressBars, 60000);  // Refresh every 60 sec
</script>

</body>
</html>
